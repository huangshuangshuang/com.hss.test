package com.hss.game.util;

import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Panel;
import java.io.File;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;

import javax.media.ControllerEvent;
import javax.media.ControllerListener;
import javax.media.Manager;
import javax.media.NoPlayerException;
import javax.media.Player;
import javax.media.PrefetchCompleteEvent;
import javax.media.RealizeCompleteEvent;
import javax.swing.JFrame;

public class Util {
	/*
	 * private static String filePath = "image/music1.mp3"; //private static
	 * final String fileUrl = "file://C:/Users/300002/Desktop/music1.mp3";
	 * public static void main(String[] args) { try { MP3File mp3File=new
	 * MP3File(filePath); System.err.println(mp3File.getAudioHeader());;
	 * mp3File.commit(); } catch (Exception e) { // TODO Auto-generated catch
	 * block e.printStackTrace(); } }
	 */
	public static void main(String[] args) {

		Frame myframe = new Frame();

		myframe.setSize(500, 500);

		myframe.setVisible(true);

		myframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

		myframe.setLocation(500, 500);

	}

}

class Frame extends JFrame implements ControllerListener {

	private static final long serialVersionUID = -561198194191551L;

	Player myPlayer = null;

	URL url = null;

	File file = new File("image/music1.mp3");

	Component vc, cc;

	Panel mypanel = new Panel();

	public Frame() {

		try {

			url = file.toURI().toURL();

		} catch (MalformedURLException e) {

			// TODO Auto-generated catch block

			e.printStackTrace();

		}

		try {

			myPlayer = Manager.createPlayer(url);
			System.err.println(myPlayer.getMediaTime().getNanoseconds());

		} catch (NoPlayerException e) {

			// TODO Auto-generated catch block

			e.printStackTrace();

		} catch (IOException e) {

			// TODO Auto-generated catch block

			e.printStackTrace();

		}

		this.add(mypanel);

		myPlayer.addControllerListener(this);

		myPlayer.prefetch();

	}

	public void controllerUpdate(ControllerEvent e) {

		// 如果是Player达到prefect状态，则开始

		if (e instanceof PrefetchCompleteEvent) {

			myPlayer.start();
			System.out.println("开始播放");
			return;

		}

		// 如果是已经完成实例，则加入控制面板，视频面板

		if (e instanceof RealizeCompleteEvent) {

			vc = myPlayer.getVisualComponent();

			if (vc != null)

				add(vc);

			cc = myPlayer.getControlPanelComponent();

			if (cc != null)

				add(cc, BorderLayout.SOUTH);

			pack();

		}
	}
}
